This is the edited version to be released to main().
